<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Inventory Management - India Shops</title>
  <link rel="stylesheet" href="style.css" />
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- SheetJS for Excel export -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
  <header>
    <h1>📦 Inventory Management System</h1>
    <p class="subtitle">Manage your shop inventory with ease</p>
  </header>

  <!-- Dashboard Stats -->
  <section class="card dashboard">
    <h2>📊 Dashboard Overview</h2>
    <div class="stats-grid" id="dashboard-stats">
      <!-- Stats will be populated by JavaScript -->
    </div>
  </section>

  <!-- Quick Actions -->
  <section class="card">
    <h2>⚡ Quick Actions</h2>
    <div class="quick-actions">
      <button onclick="showLowStockItems()" class="btn btn-warning">
        <span class="icon">⚠️</span>
        Low Stock Alert
      </button>
      <button onclick="showTopProducts()" class="btn btn-success">
        <span class="icon">🏆</span>
        Top Products
      </button>
      <button onclick="generateReport()" class="btn btn-info">
        <span class="icon">📈</span>
        Quick Report
      </button>
      <button onclick="backupData()" class="btn btn-secondary">
        <span class="icon">💾</span>
        Backup Data
      </button>
    </div>
  </section>

  <!-- Add / Edit Product -->
  <section class="card">
    <h2>➕ Add / Edit Product</h2>
    <form class="product-form" onsubmit="addOrUpdateProduct(event)">
      <div class="form-row">
        <div class="form-group">
          <label for="name">Product Name *</label>
          <input type="text" id="name" placeholder="Enter product name" required />
        </div>
        <div class="form-group">
          <label for="category">Category</label>
          <select id="category">
            <option value="">Select Category</option>
            <option value="Electronics">📱 Electronics</option>
            <option value="Clothing">👕 Clothing</option>
            <option value="Food">🍕 Food & Beverages</option>
            <option value="Books">📚 Books</option>
            <option value="Health">💊 Health & Beauty</option>
            <option value="Home">🏠 Home & Garden</option>
            <option value="Sports">⚽ Sports</option>
            <option value="Other">📦 Other</option>
          </select>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label for="qty">Quantity *</label>
          <input type="number" id="qty" placeholder="0" min="0" required />
        </div>
        <!-- Add this after the quantity input field -->
<div class="form-group">
  <label for="unit">Unit</label>
<select id="unit">
  <option value="pieces">Pieces</option>
  <option value="kg">Kilograms (KG)</option>
  <option value="grams">Grams (G)</option>
  <option value="liters">Liters (L)</option>
  <option value="ml">Milliliters (ML)</option>
  <option value="packets">Packets</option>
  <option value="boxes">Boxes</option>
  <option value="dozens">Dozens</option>
</select>

</div>
        <div class="form-group">
          <label for="price">Price (₹) *</label>
          <input type="number" id="price" placeholder="0.00" step="0.01" min="0" required />
        </div>
        <div class="form-group">
          <label for="minStock">Minimum Stock</label>
          <input type="number" id="minStock" placeholder="5" min="0" value="5" />
        </div>
      </div>
      <div class="form-actions">
        <button type="submit" id="addUpdateBtn" class="btn btn-primary">
          <span class="icon">➕</span>
          Add Product
        </button>
        <button type="button" class="btn btn-secondary" onclick="clearForm()">
          <span class="icon">🗑️</span>
          Clear
        </button>
      </div>
    </form>
  </section>

  <!-- Search & Filters -->
  <section class="card">
    <h2>🔍 Search & Filter</h2>
    <div class="search-section">
      <div class="search-bar">
        <input type="text" id="search" placeholder="🔍 Search products..." onkeyup="searchProduct()" />
        <button class="btn btn-secondary" onclick="clearSearch()">Clear</button>
      </div>
      <div class="filter-controls">
        <div class="form-group">
          <label for="sortBy">Sort by</label>
          <select id="sortBy" onchange="applySort()">
            <option value="name">Name</option>
            <option value="qty">Quantity</option>
            <option value="price">Price</option>
            <option value="category">Category</option>
            <option value="value">Total Value</option>
          </select>
        </div>
        <div class="form-group">
          <select id="sortDir" onchange="applySort()">
            <option value="asc">↑ Ascending</option>
            <option value="desc">↓ Descending</option>
          </select>
        </div>
        <div class="form-group">
          <label for="stockFilter">Stock Status</label>
          <select id="stockFilter" onchange="applySort()">
            <option value="">All Items</option>
            <option value="in-stock">In Stock</option>
            <option value="low-stock">Low Stock</option>
            <option value="out-of-stock">Out of Stock</option>
          </select>
        </div>
      </div>
      <div class="category-filters" id="category-filter">
        <!-- Category buttons will be populated by JavaScript -->
      </div>
      <div class="export-actions">
        <button onclick="exportCSV()" class="btn btn-secondary">
          <span class="icon">📄</span>
          Export CSV
        </button>
        <button onclick="exportExcel()" class="btn btn-secondary">
          <span class="icon">📊</span>
          Export Excel
        </button>
      </div>
    </div>
  </section>

  <!-- Inventory Table -->
  <section class="card">
    <div class="section-header">
      <h2>📋 Inventory <span id="inventory-count" class="count-badge"></span></h2>
      <div class="table-actions">
        <button onclick="selectAllItems()" class="btn btn-sm btn-secondary">Select All</button>
        <button onclick="deleteSelectedItems()" class="btn btn-sm btn-danger">Delete Selected</button>
      </div>
    </div>
    <div id="low-stock-alert"></div>
    <div class="table-container">
      <table class="inventory-table">
        <thead>
          <tr>
            <th><input type="checkbox" id="select-all" onchange="toggleSelectAll()"></th>
            <th>Product Name</th>
            <th>Category</th>
            <th>Quantity</th>
            <th>Unit</th>

            <th>Price (₹)</th>
            <th>Total Value (₹)</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="inventory-list"></tbody>
      </table>
    </div>
    <div id="inventory-empty" class="empty-state" style="display: none;">
      <div class="empty-icon">📦</div>
      <h3>No Products Found</h3>
      <p>Add your first product to get started with inventory management</p>
      <button onclick="$('name').focus()" class="btn btn-primary">Add First Product</button>
    </div>
  </section>

  <!-- Sales Module -->
  <section class="card">
    <h2>💰 Sales & Billing</h2>
    <div class="sales-section">
      <div class="billing-form">
        <div class="form-row">
          <div class="form-group">
            <label for="saleProduct">Select Product</label>
            <select id="saleProduct" onchange="updateSalePreview()"></select>
          </div>
          <div class="form-group">
            <label for="saleQty">Quantity</label>
            <input type="number" id="saleQty" placeholder="1" min="1" onchange="updateSalePreview()" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="saleDiscount">Discount</label>
            <input type="number" id="saleDiscount" placeholder="0" step="0.01" min="0" onchange="updateSalePreview()" />
          </div>
          <div class="form-group">
            <label for="saleDiscountType">Discount Type</label>
            <select id="saleDiscountType" onchange="updateSalePreview()">
              <option value="flat">₹ Flat Amount</option>
              <option value="percent">% Percentage</option>
            </select>
          </div>
          <div class="form-group">
            <label for="rounding">Rounding</label>
            <select id="rounding" onchange="updateSalePreview()">
              <option value="none">No Rounding</option>
              <option value="nearest1">Round to ₹1</option>
              <option value="nearest2">Round to ₹2</option>
            </select>
          </div>
        </div>
        <div class="sale-preview" id="sale-preview">
          <!-- Sale preview will be populated by JavaScript -->
        </div>
        <div class="form-actions">
          <button onclick="makeSale()" class="btn btn-success">
            <span class="icon">💳</span>
            Complete Sale
          </button>
          <button onclick="clearSaleForm()" class="btn btn-secondary">
            <span class="icon">🔄</span>
            Reset
          </button>
        </div>
      </div>
    </div>

    <h3>📋 Recent Sales</h3>
    <div class="table-container">
      <table class="sales-table">
        <thead>
          <tr>
            <th>Date & Time</th>
            <th>Product</th>
            <th>Qty</th>
            <th>Unit Price</th>
            <th>Discount</th>
            <th>Total</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="sales-list"></tbody>
      </table>
    </div>
    <div id="sales-empty" class="empty-state" style="display: none;">
      <div class="empty-icon">💰</div>
      <h3>No Sales Yet</h3>
      <p>Make your first sale to see transaction history</p>
    </div>
    <div class="totals" id="salesTotals"></div>

    <div class="sales-actions">
      <button onclick="exportSalesCSV()" class="btn btn-secondary">
        <span class="icon">📄</span>
        Export Sales CSV
      </button>
      <button onclick="exportSalesExcel()" class="btn btn-secondary">
        <span class="icon">📊</span>
        Export Sales Excel
      </button>
      <button class="btn btn-whatsapp" onclick="shareTodaySalesWhatsApp()">
        <span class="icon">📱</span>
        Share on WhatsApp
      </button>
    </div>
  </section>

  <!-- Reports -->
  <section class="card">
    <h2>📈 Sales Reports</h2>
    <div class="report-controls">
      <div class="quick-reports">
        <button onclick="renderDailyReport()" class="btn btn-info">Today</button>
        <button onclick="renderWeeklyReport()" class="btn btn-info">This Week</button>
        <button onclick="renderMonthlyReport()" class="btn btn-info">This Month</button>
      </div>
      <div class="custom-range">
        <input type="date" id="customFrom" />
        <span>to</span>
        <input type="date" id="customTo" />
        <button onclick="renderRangeReport()" class="btn btn-primary">Generate Report</button>
      </div>
      <div class="report-actions">
        <button onclick="exportReportCSV()" class="btn btn-secondary">Export CSV</button>
        <button onclick="exportReportExcel()" class="btn btn-secondary">Export Excel</button>
      </div>
    </div>

    <h3 id="reportTitle">Sales Report</h3>
    <div class="table-container">
      <table class="report-table">
        <thead>
          <tr>
            <th>Date</th>
            <th>Orders</th>
            <th>Units Sold</th>
            <th>Revenue (₹)</th>
            <th>Avg. Order Value</th>
          </tr>
        </thead>
        <tbody id="reportBody"></tbody>
      </table>
    </div>
    <div id="report-empty" class="empty-state" style="display: none;">
      <div class="empty-icon">📈</div>
      <h3>No Sales Data</h3>
      <p>No sales found for the selected period</p>
    </div>
    <div class="totals" id="reportTotals"></div>
  </section>

  <!-- Charts & Analytics -->
  <section class="card">
    <h2>📊 Analytics Dashboard</h2>
    <div class="chart-controls">
      <div class="chart-tabs">
        <button class="chart-tab active" onclick="showChart('overview')">Overview</button>
        <button class="chart-tab" onclick="showChart('stock')">Stock Analysis</button>
        <button class="chart-tab" onclick="showChart('sales')">Sales Trends</button>
        <button class="chart-tab" onclick="showChart('category')">Category Performance</button>
      </div>
    </div>
    <div class="charts-container">
      <div id="chart-overview" class="chart-section active">
        <div class="charts-grid">
          <div class="chart-wrapper">
            <h4>📦 Stock Levels by Category</h4>
            <canvas id="stockChart"></canvas>
          </div>
          <div class="chart-wrapper">
            <h4>💰 Daily Sales Revenue</h4>
            <canvas id="salesChart"></canvas>
          </div>
        </div>
      </div>
      <div id="chart-stock" class="chart-section">
        <div class="chart-wrapper">
          <h4>📊 Stock Status Distribution</h4>
          <canvas id="stockStatusChart"></canvas>
        </div>
      </div>
      <div id="chart-sales" class="chart-section">
        <div class="chart-wrapper">
          <h4>📈 Sales Performance</h4>
          <canvas id="salesTrendChart"></canvas>
        </div>
      </div>
      <div id="chart-category" class="chart-section">
        <div class="chart-wrapper">
          <h4>🏷️ Category Performance</h4>
          <canvas id="categoryChart"></canvas>
        </div>
      </div>
    </div>
  </section>

  <!-- Notifications -->
  <div id="notifications" class="notifications"></div>

  <!-- Loading Spinner -->
  <div id="loading" class="loading" style="display: none;">
    <div class="spinner"></div>
    <p>Processing...</p>
  </div>

  <footer>
    <div class="footer-content">
      <p>© 2025 Inventory Management System - Built for Indian Small Businesses</p>
      <p>Made with ❤️ by developers who care about your business growth</p>
      <div class="footer-stats" id="footer-stats">
        <!-- Footer stats will be populated by JavaScript -->
      </div>
    </div>
  </footer>

  <script src="script.js"></script>
</body>
</html>